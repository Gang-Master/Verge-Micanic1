<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ø¸Ø§Ù… Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ù…ØªÙ‚Ø¯Ù… Ù„Ù„Ù…Ø±ÙƒØ¨Ø§Øª Ø§Ù„Ø´Ø±Ø·ÙŠØ©</title>
    
    <!-- Ø±ÙˆØ§Ø¨Ø· CDN Ø§Ù„Ø¢Ù…Ù†Ø© (HTTPS) -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --admin-color: #e74c3c;
            --editor-color: #f39c12;
            --viewer-color: #27ae60;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f8f9fa;
            color: #333;
            margin: 0;
            padding: 0;
            line-height: 1.6;
        }
        
        .sidebar {
            height: 100vh;
            position: fixed;
            right: 0;
            top: 0;
            background-color: var(--primary-color);
            color: white;
            padding-top: 20px;
            width: 250px;
            transition: all 0.3s;
            z-index: 1000;
            overflow-y: auto;
        }
        
        .main-content {
            margin-right: 250px;
            padding: 20px;
            transition: all 0.3s;
            min-height: 100vh;
        }
        
        @media (max-width: 768px) {
            .sidebar {
                margin-right: -250px;
            }
            
            .sidebar.active {
                margin-right: 0;
            }
            
            .main-content {
                margin-right: 0;
            }
        }
        
        .sidebar a {
            color: white;
            text-decoration: none;
            display: block;
            padding: 15px 20px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            transition: all 0.3s;
            font-size: 14px;
        }
        
        .sidebar a:hover {
            background-color: rgba(255,255,255,0.1);
            padding-right: 25px;
        }
        
        .sidebar a.active {
            background-color: var(--secondary-color);
            border-right: 4px solid white;
        }
        
        .user-badge {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            color: white;
            margin-top: 5px;
        }
        
        .badge-admin {
            background-color: var(--admin-color);
        }
        
        .badge-editor {
            background-color: var(--editor-color);
        }
        
        .badge-viewer {
            background-color: var(--viewer-color);
        }
        
        .vehicle-card {
            border-radius: 10px;
            overflow: hidden;
            transition: all 0.3s;
            height: 100%;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            border: 1px solid #eee;
        }
        
        .vehicle-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.15);
        }
        
        .vehicle-img-container {
            height: 200px;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #f5f5f5;
            position: relative;
        }
        
        .vehicle-img {
            max-height: 100%;
            max-width: 100%;
            object-fit: cover;
            transition: transform 0.3s;
        }
        
        .vehicle-card:hover .vehicle-img {
            transform: scale(1.05);
        }
        
        .color-preview {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: inline-block;
            margin: 0 5px;
            border: 1px solid #ddd;
            cursor: pointer;
            transition: transform 0.2s;
        }
        
        .color-preview:hover {
            transform: scale(1.1);
            border-color: #007bff;
        }
        
        .login-container {
            max-width: 500px;
            margin: 100px auto;
            padding: 30px;
            border-radius: 10px;
            background-color: white;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .logo {
            font-weight: bold;
            font-size: 28px;
            color: var(--primary-color);
            text-align: center;
            margin-bottom: 20px;
        }
        
        .logo span {
            color: var(--secondary-color);
        }
        
        .section-title {
            border-bottom: 2px solid var(--secondary-color);
            padding-bottom: 10px;
            margin-bottom: 30px;
            color: var(--primary-color);
            font-weight: 600;
        }
        
        .toggle-sidebar {
            display: none;
            position: fixed;
            top: 15px;
            right: 15px;
            z-index: 1001;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 5px;
            padding: 10px 15px;
            font-size: 18px;
        }
        
        @media (max-width: 768px) {
            .toggle-sidebar {
                display: block;
            }
        }
        
        .dashboard-card {
            border-radius: 10px;
            padding: 20px;
            color: white;
            margin-bottom: 20px;
            text-align: center;
            transition: transform 0.3s;
        }
        
        .dashboard-card:hover {
            transform: translateY(-3px);
        }
        
        .dashboard-card i {
            font-size: 40px;
            margin-bottom: 15px;
        }
        
        .card-admin {
            background: linear-gradient(135deg, var(--admin-color), #c0392b);
        }
        
        .card-editor {
            background: linear-gradient(135deg, var(--editor-color), #d35400);
        }
        
        .card-viewer {
            background: linear-gradient(135deg, var(--viewer-color), #229954);
        }
        
        .card-vehicles {
            background: linear-gradient(135deg, #9b59b6, #8e44ad);
        }
        
        .copy-btn {
            cursor: pointer;
            transition: all 0.3s;
            color: #6c757d;
        }
        
        .copy-btn:hover {
            transform: scale(1.1);
            color: #007bff;
        }
        
        .rank-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 12px;
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            color: #1565c0;
            margin: 2px;
            font-weight: bold;
        }
        
        .action-buttons {
            display: flex;
            gap: 5px;
            justify-content: flex-end;
        }
        
        .action-buttons button {
            padding: 5px 10px;
            font-size: 12px;
            border-radius: 4px;
        }
        
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            color: white;
            font-size: 20px;
            backdrop-filter: blur(3px);
        }
        
        .color-option {
            cursor: pointer;
            display: inline-block;
            margin: 5px;
            transition: transform 0.2s;
        }
        
        .color-option:hover {
            transform: scale(1.1);
        }
        
        .form-control:focus {
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 0.2rem rgba(52, 152, 219, 0.25);
        }
        
        .btn-primary {
            background-color: var(--secondary-color);
            border-color: var(--secondary-color);
        }
        
        .btn-primary:hover {
            background-color: #2980b9;
            border-color: #2980b9;
        }
        
        .table-hover tbody tr:hover {
            background-color: rgba(52, 152, 219, 0.1);
        }
        
        .alert {
            border-radius: 8px;
            border: none;
        }
        
        .modal-content {
            border-radius: 10px;
            border: none;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
        }
        
        .modal-header {
            background-color: var(--primary-color);
            color: white;
            border-radius: 10px 10px 0 0;
        }
        
        .modal-header .btn-close {
            filter: invert(1);
        }
        
        .tab-content {
            padding: 20px 0;
        }
        
        .nav-tabs .nav-link {
            border-radius: 8px 8px 0 0;
            font-weight: 500;
        }
        
        .nav-tabs .nav-link.active {
            background-color: var(--secondary-color);
            color: white;
            border-color: var(--secondary-color);
        }
    </style>
</head>
<body>
    <!-- ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ -->
    <div id="login-page" class="login-container">
        <div class="text-center mb-4">
            <h1 class="logo">Ù†Ø¸Ø§Ù… <span>Ø§Ù„Ø¨Ø­Ø«</span> Ø§Ù„Ù…ØªÙ‚Ø¯Ù…</h1>
            <p class="text-muted">Ø¥Ø¯Ø§Ø±Ø© ÙˆØªØµÙØ­ Ø§Ù„Ù…Ø±ÙƒØ¨Ø§Øª Ø§Ù„Ø´Ø±Ø·ÙŠØ©</p>
            <div class="mt-3">
                <i class="fas fa-car fa-3x text-primary mb-3"></i>
            </div>
        </div>
        
        <div class="mb-3">
            <label for="login-email" class="form-label">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
            <div class="input-group">
                <span class="input-group-text"><i class="fas fa-envelope"></i></span>
                <input type="email" class="form-control" id="login-email" placeholder="Ø£Ø¯Ø®Ù„ Ø¨Ø±ÙŠØ¯Ùƒ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ" value="admin@vehicles.com">
            </div>
        </div>
        
        <div class="mb-3">
            <label for="login-password" class="form-label">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
            <div class="input-group">
                <span class="input-group-text"><i class="fas fa-lock"></i></span>
                <input type="password" class="form-control" id="login-password" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" value="Admin123">
            </div>
        </div>
        
        <div class="d-grid gap-2 mt-4">
            <button class="btn btn-primary btn-lg" onclick="login()">
                <i class="fas fa-sign-in-alt me-2"></i>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
            </button>
        </div>
        
        <div id="login-error" class="alert alert-danger mt-3 d-none">
            <i class="fas fa-exclamation-triangle me-2"></i>
            <span id="error-message"></span>
        </div>
        
        <div class="mt-4 text-center">
            <small class="text-muted">
                <i class="fas fa-info-circle me-1"></i>
                Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ù…Ø¹Ø¨Ø£Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯
            </small>
        </div>
    </div>

    <!-- Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
    <div id="dashboard" class="d-none">
        <!-- Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ†Ù‚Ù„ Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ -->
        <button class="toggle-sidebar" onclick="toggleSidebar()">
            <i class="fas fa-bars"></i>
        </button>
        
        <div class="sidebar" id="sidebar">
            <div class="text-center mb-4 px-3">
                <div class="mb-3">
                    <i class="fas fa-car fa-3x text-white"></i>
                </div>
                <h2 class="logo mb-2" style="font-size: 20px;">Ù†Ø¸Ø§Ù… <span>Ø§Ù„Ø¨Ø­Ø«</span></h2>
                <p class="text-light small mb-2" id="user-info">Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ </p>
                <span class="user-badge" id="user-role-badge">Ù…Ø¯ÙŠØ±</span>
            </div>
            
            <div class="sidebar-menu">
                <a href="#" class="active" onclick="showSection('dashboard-home')">
                    <i class="fas fa-home me-2"></i> Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
                </a>
                
                <a href="#" onclick="showSection('search-vehicles')">
                    <i class="fas fa-search me-2"></i> Ø¨Ø­Ø« Ø§Ù„Ù…Ø±ÙƒØ¨Ø§Øª
                </a>
                
                <a href="#" onclick="showSection('add-vehicle')" id="add-vehicle-link">
                    <i class="fas fa-car me-2"></i> Ø¥Ø¶Ø§ÙØ© Ù…Ø±ÙƒØ¨Ø©
                </a>
                
                <a href="#" onclick="showSection('manage-sectors')" id="manage-sectors-link">
                    <i class="fas fa-list me-2"></i> Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù‚Ø·Ø§Ø¹Ø§Øª
                </a>
                
                <a href="#" onclick="showSection('manage-ranks')" id="manage-ranks-link">
                    <i class="fas fa-user-tie me-2"></i> Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø±ØªØ¨
                </a>
                
                <a href="#" onclick="showSection('manage-colors')" id="manage-colors-link">
                    <i class="fas fa-palette me-2"></i> Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ù„ÙˆØ§Ù†
                </a>
                
                <a href="#" onclick="showSection('manage-users')" id="manage-users-link">
                    <i class="fas fa-users me-2"></i> Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
                </a>
                
                <a href="#" onclick="showSection('add-user')" id="add-user-link">
                    <i class="fas fa-user-plus me-2"></i> Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù…
                </a>
                
                <a href="#" onclick="showSection('system-tools')" id="system-tools-link">
                    <i class="fas fa-tools me-2"></i> Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ù†Ø¸Ø§Ù…
                </a>
            </div>
            
            <div class="mt-auto">
                <a href="#" onclick="logout()" class="text-center" style="background-color: rgba(255,255,255,0.1);">
                    <i class="fas fa-sign-out-alt me-2"></i> ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
                </a>
            </div>
        </div>
        
        <!-- Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
        <div class="main-content" id="main-content">
            <!-- Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
            <div id="dashboard-home" class="dashboard-section">
                <h2 class="section-title">
                    <i class="fas fa-tachometer-alt me-2"></i>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
                </h2>
                
                <div class="row">
                    <div class="col-md-3 col-sm-6">
                        <div class="dashboard-card card-admin">
                            <i class="fas fa-user-shield"></i>
                            <h4>Ø§Ù„Ù…Ø¯ÙŠØ±ÙˆÙ†</h4>
                            <h2 id="admin-count">0</h2>
                        </div>
                    </div>
                    
                    <div class="col-md-3 col-sm-6">
                        <div class="dashboard-card card-editor">
                            <i class="fas fa-edit"></i>
                            <h4>Ø§Ù„Ù…Ø­Ø±Ø±ÙˆÙ†</h4>
                            <h2 id="editor-count">0</h2>
                        </div>
                    </div>
                    
                    <div class="col-md-3 col-sm-6">
                        <div class="dashboard-card card-viewer">
                            <i class="fas fa-eye"></i>
                            <h4>Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯ÙˆÙ†</h4>
                            <h2 id="viewer-count">0</h2>
                        </div>
                    </div>
                    
                    <div class="col-md-3 col-sm-6">
                        <div class="dashboard-card card-vehicles">
                            <i class="fas fa-car"></i>
                            <h4>Ø§Ù„Ù…Ø±ÙƒØ¨Ø§Øª</h4>
                            <h2 id="vehicle-count">0</h2>
                        </div>
                    </div>
                </div>
                
                <div class="row mt-4">
                    <div class="col-md-6">
                        <div class="card border-0 shadow-sm">
                            <div class="card-body">
                                <h5 class="card-title">
                                    <i class="fas fa-history me-2 text-primary"></i>Ø¢Ø®Ø± Ø§Ù„Ù…Ø±ÙƒØ¨Ø§Øª Ø§Ù„Ù…Ø¶Ø§ÙØ©
                                </h5>
                                <div id="recent-vehicles" class="mt-3">
                                    <div class="text-center py-4">
                                        <div class="spinner-border text-primary" role="status">
                                            <span class="visually-hidden">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</span>
                                        </div>
                                        <p class="text-muted mt-2">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-6">
                        <div class="card border-0 shadow-sm">
                            <div class="card-body">
                                <h5 class="card-title">
                                    <i class="fas fa-chart-bar me-2 text-success"></i>Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù†Ø¸Ø§Ù…
                                </h5>
                                <canvas id="stats-chart" height="200"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="row mt-4" id="quick-actions">
                    <div class="col-12">
                        <div class="card border-0 shadow-sm">
                            <div class="card-body">
                                <h5 class="card-title">
                                    <i class="fas fa-bolt me-2 text-warning"></i>Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø³Ø±ÙŠØ¹Ø©
                                </h5>
                                <div class="d-flex flex-wrap gap-2 mt-3">
                                    <button class="btn btn-outline-primary" onclick="showSection('search-vehicles')">
                                        <i class="fas fa-search me-2"></i>Ø¨Ø­Ø« Ø³Ø±ÙŠØ¹
                                    </button>
                                    <button class="btn btn-outline-success" onclick="showSection('add-vehicle')" id="quick-add-vehicle">
                                        <i class="fas fa-plus me-2"></i>Ø¥Ø¶Ø§ÙØ© Ù…Ø±ÙƒØ¨Ø©
                                    </button>
                                    <button class="btn btn-outline-info" onclick="showSection('add-user')" id="quick-add-user">
                                        <i class="fas fa-user-plus me-2"></i>Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù…
                                    </button>
                                    <button class="btn btn-outline-warning" onclick="loadDefaultData()" id="quick-load-data">
                                        <i class="fas fa-database me-2"></i>ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Ù‚Ø³Ù… Ø§Ù„Ø¨Ø­Ø« -->
            <div id="search-vehicles" class="dashboard-section d-none">
                <h2 class="section-title">
                    <i class="fas fa-search me-2"></i>Ø¨Ø­Ø« Ø§Ù„Ù…Ø±ÙƒØ¨Ø§Øª
                </h2>
                
                <div class="card border-0 shadow-sm mb-4">
                    <div class="card-body">
                        <h5 class="card-title mb-3">
                            <i class="fas fa-filter me-2 text-primary"></i>ÙÙ„ØªØ± Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ù…ØªÙ‚Ø¯Ù…
                        </h5>
                        <div class="row">
                            <div class="col-md-4 mb-3">
                                <label class="form-label fw-bold">Ø§Ù„Ù‚Ø·Ø§Ø¹ *</label>
                                <select class="form-control" id="search-sector" required>
                                    <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù‚Ø·Ø§Ø¹</option>
                                </select>
                            </div>
                            
                            <div class="col-md-4 mb-3">
                                <label class="form-label fw-bold">Ø§Ù„Ø±ØªØ¨Ø© *</label>
                                <select class="form-control" id="search-rank" required>
                                    <option value="">Ø§Ø®ØªØ± Ø§Ù„Ø±ØªØ¨Ø©</option>
                                </select>
                            </div>
                            
                            <div class="col-md-4 mb-3">
                                <label class="form-label fw-bold">Ù†ÙˆØ¹ Ø§Ù„Ù…Ø±ÙƒØ¨Ø©</label>
                                <select class="form-control" id="search-type" disabled>
                                    <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù†ÙˆØ§Ø¹</option>
                                    <option value="Ø§Ù„ÙÙˆØ±Ø¯ ÙÙƒØªÙˆØ±ÙŠØ§">Ø§Ù„ÙÙˆØ±Ø¯ ÙÙƒØªÙˆØ±ÙŠØ§</option>
                                    <option value="Ø§Ù„Ø¯ÙˆØ¯Ø¬ ØªØ´Ø§Ø±Ø¬Ø±">Ø§Ù„Ø¯ÙˆØ¯Ø¬ ØªØ´Ø§Ø±Ø¬Ø±</option>
                                    <option value="ÙÙˆØ±Ø¯ Ø§ÙƒØ³Ø¨Ù„ÙˆØ±">ÙÙˆØ±Ø¯ Ø§ÙƒØ³Ø¨Ù„ÙˆØ±</option>
                                    <option value="ØªØ§Ù‡Ùˆ">ØªØ§Ù‡Ùˆ</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="d-grid gap-2 d-md-flex justify-content-md-end mt-3">
                            <button class="btn btn-primary px-4" onclick="searchVehicles()">
                                <i class="fas fa-search me-2"></i>Ø¨Ø­Ø«
                            </button>
                            <button class="btn btn-outline-secondary px-4" onclick="resetSearch()">
                                <i class="fas fa-redo me-2"></i>Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="row" id="search-results">
                    <div class="col-12">
                        <div class="card border-0 shadow-sm">
                            <div class="card-body text-center py-5">
                                <i class="fas fa-car fa-4x text-muted mb-3"></i>
                                <h4 class="text-muted">Ù‚Ù… Ø¨Ø¥Ø¬Ø±Ø§Ø¡ Ø¨Ø­Ø« Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø±ÙƒØ¨Ø§Øª</h4>
                                <p class="text-muted mt-2">Ø§Ø®ØªØ± Ø§Ù„Ù‚Ø·Ø§Ø¹ ÙˆØ§Ù„Ø±ØªØ¨Ø© Ø«Ù… Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± Ø§Ù„Ø¨Ø­Ø«</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… (Ù…Ø®ÙØ¶Ø© Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±) -->
            <div id="add-vehicle" class="dashboard-section d-none">
                <h2 class="section-title">
                    <i class="fas fa-car me-2"></i>Ø¥Ø¶Ø§ÙØ© Ù…Ø±ÙƒØ¨Ø© Ø¬Ø¯ÙŠØ¯Ø©
                </h2>
                <div class="alert alert-info">
                    <i class="fas fa-info-circle me-2"></i>
                    Ù‚Ø³Ù… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø±ÙƒØ¨Ø© Ù‚ÙŠØ¯ Ø§Ù„ØªØ·ÙˆÙŠØ± ÙˆØ³ÙŠÙƒÙˆÙ† Ø¬Ø§Ù‡Ø²Ø§Ù‹ Ù‚Ø±ÙŠØ¨Ø§Ù‹
                </div>
            </div>
            
            <div id="system-tools" class="dashboard-section d-none">
                <h2 class="section-title">
                    <i class="fas fa-tools me-2"></i>Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ù†Ø¸Ø§Ù…
                </h2>
                <div class="alert alert-info">
                    <i class="fas fa-info-circle me-2"></i>
                    Ù‚Ø³Ù… Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ù†Ø¸Ø§Ù… Ù‚ÙŠØ¯ Ø§Ù„ØªØ·ÙˆÙŠØ±
                </div>
            </div>
            
            <!-- Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ø£Ø®Ø±Ù‰ -->
            <div id="manage-sectors" class="dashboard-section d-none">
                <h2 class="section-title">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù‚Ø·Ø§Ø¹Ø§Øª</h2>
                <div class="alert alert-info">Ù‚ÙŠØ¯ Ø§Ù„ØªØ·ÙˆÙŠØ±</div>
            </div>
            
            <div id="manage-ranks" class="dashboard-section d-none">
                <h2 class="section-title">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø±ØªØ¨</h2>
                <div class="alert alert-info">Ù‚ÙŠØ¯ Ø§Ù„ØªØ·ÙˆÙŠØ±</div>
            </div>
            
            <div id="manage-colors" class="dashboard-section d-none">
                <h2 class="section-title">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ù„ÙˆØ§Ù†</h2>
                <div class="alert alert-info">Ù‚ÙŠØ¯ Ø§Ù„ØªØ·ÙˆÙŠØ±</div>
            </div>
            
            <div id="manage-users" class="dashboard-section d-none">
                <h2 class="section-title">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</h2>
                <div class="alert alert-info">Ù‚ÙŠØ¯ Ø§Ù„ØªØ·ÙˆÙŠØ±</div>
            </div>
            
            <div id="add-user" class="dashboard-section d-none">
                <h2 class="section-title">Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù…</h2>
                <div class="alert alert-info">Ù‚ÙŠØ¯ Ø§Ù„ØªØ·ÙˆÙŠØ±</div>
            </div>
        </div>
    </div>

    <!-- Ù…ÙƒØªØ¨Ø§Øª JavaScript -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>

    <!-- Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
    <script>
        // ØªØ®Ø·ÙŠ Ù…Ø´ÙƒÙ„Ø© Mixed Content Ø¨ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø¥Ù„Ù‰ HTTPS
        function convertToHttps(url) {
            if (url.startsWith('http://')) {
                return url.replace('http://', 'https://');
            }
            return url;
        }

        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCg3Dmf_Odgfm2IL1IZXr_Kl16IaqiWqso",
            authDomain: "verg-micanic.firebaseapp.com",
            databaseURL: "https://verg-micanic-default-rtdb.firebaseio.com",
            projectId: "verg-micanic",
            storageBucket: "verg-micanic.firebasestorage.app",
            messagingSenderId: "881689454596",
            appId: "1:881689454596:web:e630ad9f555ba8feabed51",
            measurementId: "G-B9JZ3CR9GS"
        };

        // Initialize Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const database = firebase.database();
        
        // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        let currentUser = null;
        let userRole = null;
        let sectors = [];
        let ranks = [];
        let vehicles = [];
        let users = [];
        let colors = [];
        let vehiclesChart = null;

        // Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        document.addEventListener('DOMContentLoaded', function() {
            console.log('âœ… Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¬Ø§Ù‡Ø² Ù„Ù„Ø¹Ù…Ù„');
            
            // Ø¥Ø¹Ø¯Ø§Ø¯ Firebase Authentication
            auth.setPersistence(firebase.auth.Auth.Persistence.LOCAL)
                .then(() => {
                    console.log('âœ… ØªÙ… Ø¥Ø¹Ø¯Ø§Ø¯ Ù…ØµØ§Ø¯Ù‚Ø© Firebase');
                    
                    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø§Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
                    return auth.onAuthStateChanged(function(user) {
                        if (user) {
                            console.log('ğŸ‘¤ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¬Ù„:', user.email);
                            currentUser = user;
                            loadUserData();
                        } else {
                            console.log('ğŸ‘¤ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¬Ù„');
                            showLogin();
                        }
                    });
                })
                .catch((error) => {
                    console.error('âŒ Ø®Ø·Ø£ ÙÙŠ Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©:', error);
                    showLogin();
                });
            
            // Ø¥Ø¹Ø¯Ø§Ø¯ Ù…Ø³ØªÙ…Ø¹ÙŠ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ù„Ù„Ù†Ù…Ø§Ø°Ø¬
            setupEventListeners();
            
            // Ø¥Ø¶Ø§ÙØ© CSS Ø¥Ø¶Ø§ÙÙŠØ©
            addCustomCSS();
        });

        // ========== Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© ==========
        function login() {
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            const errorElement = document.getElementById('login-error');
            const errorMessage = document.getElementById('error-message');
            
            if (!email || !password) {
                showError('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±');
                return;
            }
            
            showLoading('Ø¬Ø§Ø±ÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„...');
            
            auth.signInWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    currentUser = userCredential.user;
                    hideLoading();
                    showToast('âœ… ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­!', 'success');
                })
                .catch((error) => {
                    hideLoading();
                    const errorMsg = getAuthErrorMessage(error.code);
                    console.error('âŒ Ø®Ø·Ø£ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„:', errorMsg);
                    showError(errorMsg);
                });
        }

        function logout() {
            auth.signOut().then(() => {
                currentUser = null;
                userRole = null;
                showLogin();
                showToast('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ Ø¨Ù†Ø¬Ø§Ø­', 'info');
            });
        }

        // ========== Ø¯ÙˆØ§Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ==========
        function loadUserData() {
            showLoading('Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…...');
            
            const userRef = database.ref('users/' + currentUser.uid);
            
            userRef.once('value')
                .then((snapshot) => {
                    const userData = snapshot.val();
                    
                    if (!userData) {
                        // Ø¥Ù†Ø´Ø§Ø¡ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† Ù…ÙˆØ¬ÙˆØ¯Ø©
                        return createUserData(currentUser);
                    }
                    
                    return userData;
                })
                .then((userData) => {
                    if (userData) {
                        userRole = userData.role;
                        
                        // ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                        document.getElementById('user-info').textContent = `Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ ${userData.name}`;
                        const roleBadge = document.getElementById('user-role-badge');
                        roleBadge.textContent = getRoleName(userData.role);
                        roleBadge.className = `user-badge badge-${userData.role}`;
                        
                        // Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª
                        updatePermissions(userData.role);
                        
                        // Ø¥Ø¸Ù‡Ø§Ø± Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
                        showDashboard();
                        
                        // ØªØ­Ù…ÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                        return loadAllData();
                    }
                })
                .then(() => {
                    hideLoading();
                    console.log('âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­');
                })
                .catch((error) => {
                    hideLoading();
                    console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:', error);
                    showError('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŒ ÙŠØ±Ø¬Ù‰ Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©');
                });
        }

        function createUserData(user) {
            const userData = {
                name: user.email.split('@')[0],
                email: user.email,
                role: "admin", // Ø¬Ø¹Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ø¬Ø¯Ø¯ Ù…Ø¯Ø±Ø§Ø¡ Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±
                createdAt: new Date().toISOString(),
                createdBy: user.uid
            };
            
            return database.ref('users/' + user.uid).set(userData)
                .then(() => {
                    console.log('âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯');
                    return userData;
                });
        }

        function loadAllData() {
            return Promise.all([
                loadSectors(),
                loadRanks(),
                loadVehicles(),
                loadUsers(),
                loadColors()
            ]).then(() => {
                updateDashboardStats();
                showToast('âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­', 'success');
            });
        }

        function loadSectors() {
            return database.ref('sectors').once('value')
                .then((snapshot) => {
                    sectors = [];
                    if (snapshot.exists()) {
                        snapshot.forEach((childSnapshot) => {
                            sectors.push({
                                id: childSnapshot.key,
                                ...childSnapshot.val()
                            });
                        });
                    }
                    
                    updateSectorDropdowns();
                    console.log(`âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ ${sectors.length} Ù‚Ø·Ø§Ø¹`);
                });
        }

        function loadRanks() {
            return database.ref('ranks').once('value')
                .then((snapshot) => {
                    ranks = [];
                    if (snapshot.exists()) {
                        snapshot.forEach((childSnapshot) => {
                            ranks.push({
                                id: childSnapshot.key,
                                ...childSnapshot.val()
                            });
                        });
                    }
                    
                    updateRankDropdowns();
                    console.log(`âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ ${ranks.length} Ø±ØªØ¨Ø©`);
                });
        }

        function loadVehicles() {
            return database.ref('vehicles').once('value')
                .then((snapshot) => {
                    vehicles = [];
                    if (snapshot.exists()) {
                        snapshot.forEach((childSnapshot) => {
                            const vehicle = childSnapshot.val();
                            // ØªØ­ÙˆÙŠÙ„ Ø±ÙˆØ§Ø¨Ø· Ø§Ù„ØµÙˆØ± Ø¥Ù„Ù‰ HTTPS
                            if (vehicle.image && vehicle.image.startsWith('http://')) {
                                vehicle.image = convertToHttps(vehicle.image);
                            }
                            vehicles.push({
                                id: childSnapshot.key,
                                ...vehicle
                            });
                        });
                    }
                    
                    updateRecentVehicles();
                    console.log(`âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ ${vehicles.length} Ù…Ø±ÙƒØ¨Ø©`);
                });
        }

        function loadUsers() {
            return database.ref('users').once('value')
                .then((snapshot) => {
                    users = [];
                    if (snapshot.exists()) {
                        snapshot.forEach((childSnapshot) => {
                            users.push({
                                id: childSnapshot.key,
                                ...childSnapshot.val()
                            });
                        });
                    }
                    
                    console.log(`âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ ${users.length} Ù…Ø³ØªØ®Ø¯Ù…`);
                });
        }

        function loadColors() {
            return database.ref('colors').once('value')
                .then((snapshot) => {
                    colors = [];
                    if (snapshot.exists()) {
                        snapshot.forEach((childSnapshot) => {
                            colors.push({
                                id: childSnapshot.key,
                                ...childSnapshot.val()
                            });
                        });
                    }
                    
                    console.log(`âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ ${colors.length} Ù„ÙˆÙ†`);
                });
        }

        // ========== Ø¯ÙˆØ§Ù„ Ø§Ù„Ø¹Ø±Ø¶ ==========
        function showLogin() {
            document.getElementById('login-page').classList.remove('d-none');
            document.getElementById('dashboard').classList.add('d-none');
        }

        function showDashboard() {
            document.getElementById('login-page').classList.add('d-none');
            document.getElementById('dashboard').classList.remove('d-none');
            showSection('dashboard-home');
        }

        function showSection(sectionId) {
            // Ø¥Ø®ÙØ§Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…
            document.querySelectorAll('.dashboard-section').forEach(section => {
                section.classList.add('d-none');
            });
            
            // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù†Ø´Ø· Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ©
            document.querySelectorAll('.sidebar a').forEach(link => {
                link.classList.remove('active');
            });
            
            // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ù…Ø·Ù„ÙˆØ¨
            const targetSection = document.getElementById(sectionId);
            if (targetSection) {
                targetSection.classList.remove('d-none');
            }
            
            // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù†Ø´Ø· Ø¥Ù„Ù‰ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ©
            const activeLink = document.querySelector(`.sidebar a[onclick*="${sectionId}"]`);
            if (activeLink) {
                activeLink.classList.add('active');
            }
        }

        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            sidebar.classList.toggle('active');
        }

        // ========== Ø¯ÙˆØ§Ù„ Ø§Ù„Ø¨Ø­Ø« ==========
        function updateSectorDropdowns() {
            const searchSector = document.getElementById('search-sector');
            if (searchSector) {
                let options = '<option value="">Ø§Ø®ØªØ± Ø§Ù„Ù‚Ø·Ø§Ø¹</option>';
                sectors.forEach(sector => {
                    options += `<option value="${sector.id}">${sector.name}</option>`;
                });
                searchSector.innerHTML = options;
                
                // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„ÙÙ„ØªØ±
                searchSector.addEventListener('change', updateFilterState);
            }
        }

        function updateRankDropdowns() {
            const searchRank = document.getElementById('search-rank');
            if (searchRank) {
                let options = '<option value="">Ø§Ø®ØªØ± Ø§Ù„Ø±ØªØ¨Ø©</option>';
                ranks.forEach(rank => {
                    options += `<option value="${rank.id}">${rank.name}</option>`;
                });
                searchRank.innerHTML = options;
                
                // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„ÙÙ„ØªØ±
                searchRank.addEventListener('change', updateFilterState);
            }
        }

        function updateFilterState() {
            const sector = document.getElementById('search-sector').value;
            const rank = document.getElementById('search-rank').value;
            const typeSelect = document.getElementById('search-type');
            
            // ØªÙØ¹ÙŠÙ„ Ù†ÙˆØ¹ Ø§Ù„Ù…Ø±ÙƒØ¨Ø© Ø¥Ø°Ø§ ØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù‚Ø·Ø§Ø¹ ÙˆØ§Ù„Ø±ØªØ¨Ø©
            typeSelect.disabled = !(sector && rank);
        }

        function searchVehicles() {
            const sector = document.getElementById('search-sector').value;
            const rank = document.getElementById('search-rank').value;
            const type = document.getElementById('search-type').value;
            
            if (!sector) {
                showToast('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù‚Ø·Ø§Ø¹ Ø£ÙˆÙ„Ø§Ù‹', 'error');
                return;
            }
            
            if (!rank) {
                showToast('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø±ØªØ¨Ø© Ø£ÙˆÙ„Ø§Ù‹', 'error');
                return;
            }
            
            showLoading('Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ø±ÙƒØ¨Ø§Øª...');
            
            // ØªØµÙÙŠØ© Ø§Ù„Ù…Ø±ÙƒØ¨Ø§Øª
            let filteredVehicles = vehicles.filter(v => v.sector === sector && v.rank === rank);
            
            if (type) {
                filteredVehicles = filteredVehicles.filter(v => v.type === type);
            }
            
            setTimeout(() => {
                hideLoading();
                displayVehicles(filteredVehicles);
            }, 500);
        }

        function resetSearch() {
            document.getElementById('search-sector').value = '';
            document.getElementById('search-rank').value = '';
            document.getElementById('search-type').value = '';
            document.getElementById('search-type').disabled = true;
            
            // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø¨Ø­Ø«
            const container = document.getElementById('search-results');
            container.innerHTML = `
                <div class="col-12">
                    <div class="card border-0 shadow-sm">
                        <div class="card-body text-center py-5">
                            <i class="fas fa-car fa-4x text-muted mb-3"></i>
                            <h4 class="text-muted">Ù‚Ù… Ø¨Ø¥Ø¬Ø±Ø§Ø¡ Ø¨Ø­Ø« Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø±ÙƒØ¨Ø§Øª</h4>
                            <p class="text-muted mt-2">Ø§Ø®ØªØ± Ø§Ù„Ù‚Ø·Ø§Ø¹ ÙˆØ§Ù„Ø±ØªØ¨Ø© Ø«Ù… Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± Ø§Ù„Ø¨Ø­Ø«</p>
                        </div>
                    </div>
                </div>
            `;
        }

        function displayVehicles(vehiclesToDisplay) {
            const container = document.getElementById('search-results');
            
            if (vehiclesToDisplay.length === 0) {
                container.innerHTML = `
                    <div class="col-12">
                        <div class="card border-0 shadow-sm">
                            <div class="card-body text-center py-5">
                                <i class="fas fa-car fa-4x text-muted mb-3"></i>
                                <h4 class="text-muted">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø±ÙƒØ¨Ø§Øª Ù…Ø·Ø§Ø¨Ù‚Ø© Ù„Ù„Ø¨Ø­Ø«</h4>
                                <p class="text-muted mt-2">Ø¬Ø±Ø¨ ØªØºÙŠÙŠØ± Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ø¨Ø­Ø«</p>
                            </div>
                        </div>
                    </div>
                `;
                return;
            }
            
            let html = '';
            
            vehiclesToDisplay.forEach(vehicle => {
                const sectorName = getSectorName(vehicle.sector);
                const rankName = getRankName(vehicle.rank);
                
                html += `
                    <div class="col-md-4 col-sm-6 mb-4">
                        <div class="card vehicle-card h-100">
                            <div class="vehicle-img-container">
                                <img src="${vehicle.image}" 
                                     class="vehicle-img" 
                                     alt="${vehicle.type}"
                                     onerror="this.onerror=null; this.src='https://via.placeholder.com/300x200/4c4c4c/FFFFFF?text=${encodeURIComponent(vehicle.type)}'">
                                <div class="position-absolute top-0 start-0 m-2">
                                    <span class="rank-badge">${rankName}</span>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="d-flex justify-content-between align-items-start mb-2">
                                    <h5 class="card-title mb-0 text-primary">${vehicle.type}</h5>
                                    <div class="action-buttons">
                                        <button class="btn btn-sm btn-outline-primary copy-btn" onclick="copyToClipboard('${vehicle.code}')" title="Ù†Ø³Ø® Ø§Ù„ÙƒÙˆØ¯">
                                            <i class="fas fa-copy"></i>
                                        </button>
                                        <button class="btn btn-sm btn-outline-info copy-btn" onclick="copyToClipboard('${vehicle.image}')" title="Ù†Ø³Ø® Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø©">
                                            <i class="fas fa-link"></i>
                                        </button>
                                    </div>
                                </div>
                                <p class="card-text">
                                    <strong><i class="fas fa-building me-1"></i>Ø§Ù„Ù‚Ø·Ø§Ø¹:</strong> ${sectorName}<br>
                                    <strong><i class="fas fa-code me-1"></i>Ø§Ù„ÙƒÙˆØ¯:</strong> <code>${vehicle.code}</code><br>
                                    <strong><i class="fas fa-palette me-1"></i>Ø§Ù„Ø£Ù„ÙˆØ§Ù†:</strong>
                                    <span class="color-preview" style="background-color: #${vehicle.primaryColor};" 
                                          title="Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø£ÙˆÙ„: #${vehicle.primaryColor}"
                                          onclick="copyToClipboard('#${vehicle.primaryColor}')"></span>
                                    <span class="color-preview" style="background-color: #${vehicle.secondaryColor};" 
                                          title="Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ: #${vehicle.secondaryColor}"
                                          onclick="copyToClipboard('#${vehicle.secondaryColor}')"></span>
                                    <button class="btn btn-sm btn-link p-0 copy-btn" onclick="copyColors('${vehicle.primaryColor}', '${vehicle.secondaryColor}')" title="Ù†Ø³Ø® ÙƒÙ„Ø§ Ø§Ù„Ù„ÙˆÙ†ÙŠÙ†">
                                        <i class="fas fa-copy"></i>
                                    </button>
                                </p>
                                ${vehicle.notes ? `
                                    <div class="alert alert-light mt-3 p-2">
                                        <small><i class="fas fa-sticky-note me-1"></i>${vehicle.notes}</small>
                                    </div>
                                ` : ''}
                            </div>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        // ========== Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© ==========
        function getSectorName(sectorId) {
            const sector = sectors.find(s => s.id === sectorId);
            return sector ? sector.name : 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ';
        }

        function getRankName(rankId) {
            const rank = ranks.find(r => r.id === rankId);
            return rank ? rank.name : 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ';
        }

        function getRoleName(roleCode) {
            const roles = {
                'admin': 'Ù…Ø¯ÙŠØ±',
                'editor': 'Ù…Ø­Ø±Ø±',
                'viewer': 'Ù…Ø´Ø§Ù‡Ø¯'
            };
            return roles[roleCode] || roleCode;
        }

        function getAuthErrorMessage(errorCode) {
            const messages = {
                'auth/invalid-email': 'Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ ØºÙŠØ± ØµØ§Ù„Ø­',
                'auth/user-disabled': 'Ù‡Ø°Ø§ Ø§Ù„Ø­Ø³Ø§Ø¨ Ù…Ø¹Ø·Ù„',
                'auth/user-not-found': 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø­Ø³Ø§Ø¨ Ø¨Ù‡Ø°Ø§ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ',
                'auth/wrong-password': 'ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©',
                'auth/email-already-in-use': 'Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„ÙØ¹Ù„',
                'auth/weak-password': 'ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± Ø¶Ø¹ÙŠÙØ©ØŒ ÙŠØ¬Ø¨ Ø£Ù† ØªØªÙƒÙˆÙ† Ù…Ù† 6 Ø£Ø­Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„',
                'auth/operation-not-allowed': 'Ø¹Ù…Ù„ÙŠØ© Ø§Ù„ØªØ³Ø¬ÙŠÙ„ ØºÙŠØ± Ù…Ø³Ù…ÙˆØ­Ø© Ø­Ø§Ù„ÙŠØ§Ù‹',
                'auth/too-many-requests': 'ØªÙ… Ø±ÙØ¶ Ø§Ù„ÙˆØµÙˆÙ„ Ø¨Ø³Ø¨Ø¨ Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ù…ØªÙƒØ±Ø±Ø©ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù„Ø§Ø­Ù‚Ø§Ù‹'
            };
            
            return messages[errorCode] || 'Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰';
        }

        function copyColors(primary, secondary) {
            const text = `Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø£ÙˆÙ„: #${primary}\nØ§Ù„Ù„ÙˆÙ† Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ: #${secondary}`;
            copyToClipboard(text);
            showToast('âœ… ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø§ÙØ¸Ø©', 'success');
        }

        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                showToast('âœ… ØªÙ… Ø§Ù„Ù†Ø³Ø® Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø§ÙØ¸Ø©', 'success');
            }).catch(err => {
                console.error('ÙØ´Ù„ Ø§Ù„Ù†Ø³Ø®:', err);
                showToast('âŒ ÙØ´Ù„ Ø§Ù„Ù†Ø³Ø® Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø§ÙØ¸Ø©', 'error');
            });
        }

        function updateRecentVehicles() {
            const container = document.getElementById('recent-vehicles');
            if (!container) return;
            
            const recentVehicles = vehicles.slice(-5).reverse();
            
            if (recentVehicles.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-3">
                        <p class="text-muted"><i class="fas fa-info-circle me-1"></i>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø±ÙƒØ¨Ø§Øª Ù…Ø¶Ø§ÙØ© Ø¨Ø¹Ø¯</p>
                    </div>
                `;
                return;
            }
            
            let html = '<div class="list-group">';
            
            recentVehicles.forEach(vehicle => {
                const sectorName = getSectorName(vehicle.sector);
                html += `
                    <div class="list-group-item list-group-item-action border-0 mb-2 rounded" 
                         style="cursor: pointer;"
                         onclick="showSection('search-vehicles')">
                        <div class="d-flex align-items-center">
                            <div class="flex-shrink-0">
                                <i class="fas fa-car text-primary"></i>
                            </div>
                            <div class="flex-grow-1 ms-3">
                                <h6 class="mb-1">${vehicle.type}</h6>
                                <small class="text-muted">${sectorName} - ${vehicle.code}</small>
                            </div>
                            <div class="flex-shrink-0">
                                <small class="text-muted">${formatDate(vehicle.createdAt)}</small>
                            </div>
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            container.innerHTML = html;
        }

        function formatDate(dateString) {
            try {
                const date = new Date(dateString);
                return date.toLocaleDateString('ar-EG');
            } catch (e) {
                return 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ';
            }
        }

        function updateDashboardStats() {
            const adminCount = users.filter(u => u.role === 'admin').length;
            const editorCount = users.filter(u => u.role === 'editor').length;
            const viewerCount = users.filter(u => u.role === 'viewer').length;
            
            document.getElementById('admin-count').textContent = adminCount;
            document.getElementById('editor-count').textContent = editorCount;
            document.getElementById('viewer-count').textContent = viewerCount;
            document.getElementById('vehicle-count').textContent = vehicles.length;
            
            updateChart();
        }

        function updateChart() {
            const ctx = document.getElementById('stats-chart');
            if (!ctx) return;
            
            // ØªØ¯Ù…ÙŠØ± Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ Ø§Ù„Ù‚Ø¯ÙŠÙ… Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ÙˆØ¬ÙˆØ¯Ø§Ù‹
            if (vehiclesChart) {
                vehiclesChart.destroy();
            }
            
            // ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø±ÙƒØ¨Ø§Øª Ø­Ø³Ø¨ Ø§Ù„Ù†ÙˆØ¹
            const vehicleTypes = ["Ø§Ù„ÙÙˆØ±Ø¯ ÙÙƒØªÙˆØ±ÙŠØ§", "Ø§Ù„Ø¯ÙˆØ¯Ø¬ ØªØ´Ø§Ø±Ø¬Ø±", "ÙÙˆØ±Ø¯ Ø§ÙƒØ³Ø¨Ù„ÙˆØ±", "ØªØ§Ù‡Ùˆ"];
            const vehicleCounts = vehicleTypes.map(type => 
                vehicles.filter(v => v.type === type).length
            );
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ
            vehiclesChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: vehicleTypes,
                    datasets: [{
                        label: 'Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø±ÙƒØ¨Ø§Øª',
                        data: vehicleCounts,
                        backgroundColor: [
                            'rgba(52, 152, 219, 0.7)',
                            'rgba(231, 76, 60, 0.7)',
                            'rgba(46, 204, 113, 0.7)',
                            'rgba(155, 89, 182, 0.7)'
                        ],
                        borderColor: [
                            'rgb(52, 152, 219)',
                            'rgb(231, 76, 60)',
                            'rgb(46, 204, 113)',
                            'rgb(155, 89, 182)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 1
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
        }

        function updatePermissions(role) {
            const adminElements = ['add-vehicle-link', 'manage-sectors-link', 'manage-ranks-link', 
                                 'manage-colors-link', 'manage-users-link', 'add-user-link', 
                                 'system-tools-link', 'quick-add-vehicle', 'quick-add-user', 
                                 'quick-load-data'];
            
            adminElements.forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.style.display = role === 'admin' ? 'block' : 'none';
                }
            });
        }

        function setupEventListeners() {
            // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„ÙÙ„Ø§ØªØ± Ø¹Ù†Ø¯ Ø§Ù„ØªØºÙŠÙŠØ±
            const sectorSelect = document.getElementById('search-sector');
            const rankSelect = document.getElementById('search-rank');
            
            if (sectorSelect) {
                sectorSelect.addEventListener('change', updateFilterState);
            }
            
            if (rankSelect) {
                rankSelect.addEventListener('change', updateFilterState);
            }
            
            // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬ÙŠÙ‡
            document.addEventListener('click', function(e) {
                if (e.target.id === 'loading-overlay') {
                    hideLoading();
                }
            });
        }

        function addCustomCSS() {
            const style = document.createElement('style');
            style.textContent = `
                .btn:focus {
                    box-shadow: 0 0 0 0.25rem rgba(52, 152, 219, 0.5);
                }
                
                .card {
                    transition: transform 0.3s, box-shadow 0.3s;
                }
                
                .card:hover {
                    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
                }
                
                .list-group-item:hover {
                    background-color: #f8f9fa;
                    transform: translateX(-5px);
                }
                
                .spinner-border {
                    width: 3rem;
                    height: 3rem;
                }
                
                @keyframes fadeIn {
                    from { opacity: 0; transform: translateY(20px); }
                    to { opacity: 1; transform: translateY(0); }
                }
                
                .dashboard-section {
                    animation: fadeIn 0.5s ease-out;
                }
            `;
            document.head.appendChild(style);
        }

        function showError(message) {
            const errorElement = document.getElementById('login-error');
            const errorMessage = document.getElementById('error-message');
            
            if (errorElement && errorMessage) {
                errorMessage.textContent = message;
                errorElement.classList.remove('d-none');
            }
        }

        function showLoading(message = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...') {
            let loadingDiv = document.getElementById('loading-overlay');
            
            if (!loadingDiv) {
                loadingDiv = document.createElement('div');
                loadingDiv.id = 'loading-overlay';
                loadingDiv.className = 'loading-overlay';
                loadingDiv.innerHTML = `
                    <div class="text-center">
                        <div class="spinner-border text-light" role="status">
                            <span class="visually-hidden">Loading...</span>
                        </div>
                        <p class="mt-3 text-light">${message}</p>
                    </div>
                `;
                document.body.appendChild(loadingDiv);
            } else {
                loadingDiv.style.display = 'flex';
                loadingDiv.querySelector('p').textContent = message;
            }
        }

        function hideLoading() {
            const loadingDiv = document.getElementById('loading-overlay');
            if (loadingDiv) {
                loadingDiv.style.display = 'none';
            }
        }

        function showToast(message, type = 'info') {
            const bgColor = type === 'success' ? '#28a745' : 
                            type === 'error' ? '#dc3545' : 
                            type === 'warning' ? '#ffc107' : 
                            '#17a2b8';
            
            Toastify({
                text: message,
                duration: 3000,
                close: true,
                gravity: "top",
                position: "center",
                backgroundColor: bgColor,
                stopOnFocus: true,
                className: "text-end",
                style: {
                    borderRadius: '8px',
                    padding: '15px',
                    fontSize: '14px'
                }
            }).showToast();
        }

        // Ø¯Ø§Ù„Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
        function loadDefaultData() {
            if (!confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ù„Ù„Ù†Ø¸Ø§Ù…ØŸ')) {
                return;
            }
            
            showLoading('Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©...');
            
            // Ø¥Ø¶Ø§ÙØ© Ø¨ÙŠØ§Ù†Ø§Øª Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ù‡Ù†Ø§ Ù„Ø§Ø­Ù‚Ø§Ù‹
            setTimeout(() => {
                hideLoading();
                showToast('âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­', 'success');
                loadAllData(); // Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            }, 2000);
        }

        // Ø¨Ø¯Ø§ÙŠØ© ØªØ´ØºÙŠÙ„ Ø§Ù„Ù†Ø¸Ø§Ù…
        console.log('ğŸš€ Ù†Ø¸Ø§Ù… Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ù…ØªÙ‚Ø¯Ù… Ù„Ù„Ù…Ø±ÙƒØ¨Ø§Øª Ø§Ù„Ø´Ø±Ø·ÙŠØ© - ØªÙ… Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­');
        console.log('ğŸ“§ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ù…Ø¯Ø®Ù„: ' + (document.getElementById('login-email')?.value || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'));
        console.log('ğŸ”‘ Ø¬Ø§Ù‡Ø² Ù„Ù„ØªØ³Ø¬ÙŠÙ„...');
    </script>
</body>
</html>
